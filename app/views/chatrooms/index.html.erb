<div class="container my-5 text-center">
  <h1>Messages</h1>
</div>
<div class="container">
  <% @my_chatrooms.each do |chatroom| %>
    <div class="card-chat">
      <% if  (@current_user == chatroom.user2 && !chatroom.user1.image.attached?) || (@current_user == chatroom.user1 && !chatroom.user2.image.attached?) %>
      <div class="text-center avatar-container d-flex justify-content-center align-items-center">
        <%= image_tag "/assets/default_avatar.png", class: "avatar-img" %>
      </div>
      <% else %>
        <%= cl_image_tag (@current_user == chatroom.user2 ? chatroom.user1.image.key : chatroom.user2.image.key), class: '' %>
      <% end %>
      <div class="card-chat-infos">
        <h2><%= link_to (@current_user == chatroom.user2 ? chatroom.user1.first_name : chatroom.user2.first_name), chatroom_path(chatroom), class: 'stretched-link' %></h2>
        <p><%= chatroom.messages.last.content if chatroom.messages.empty? == false %></p>
      </div>
    </div>
  <% end %>


  <div class="container my-5 text-center">
    <h2 >Bookmarked Events</h2>
    <ul>
      <% current_user.bookmarked_events.each do |event| %>
      <% if  event.votes_for[0].vote_flag %>
        <div class="card-chat">
          <%= cl_image_tag (event.image.key), class: "avatar-img"%>
          <%= link_to event.name, event %>
          <%= link_to "Unsave", downvote_event_path(event , type: "bookmark") ,data: {turbo_method: :put}, class: "unsave m-3" %></li>
        </div>
      <% else  %>
        <%= nil %>
      <% end %>
    <% end %>
    </ul>
  </div>

  <div class="container my-5 text-center">
    <h2 >Bookmarked Babysitters</h2>
    <ul>
    <% current_user.bookmarked_babysitters.each do |babysitter| %>
    <% if  babysitter.votes_for[0].vote_flag %>
      <div class="card-chat">
        <%= cl_image_tag (babysitter.image.key), class: "avatar-img"%>
        <%= link_to babysitter.first_name, babysitter %>
        <%= link_to "Unsave", downvote_babysitter_path(babysitter , type: "bookmark") ,data: {turbo_method: :put}, class: "unsave m-3" %></li>
      </div>
      <% else  %>
        <%= nil %>
      <% end %>
    <% end %>
    </ul>
  </div>
</div>
